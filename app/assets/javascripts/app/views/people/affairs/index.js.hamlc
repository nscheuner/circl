%table.datatable
  %thead
    %tr
      %th= I18n.t('common.id')
      %th= I18n.t('common.title')
      %th= I18n.t('affair.views.value')
      %th= I18n.t('affair.views.invoices_value')
      %th= I18n.t('affair.views.receipts_value')
      %th= I18n.t('affair.views.status')
      %th.desc= I18n.t('common.created_at')

  %tbody
    - for affair in App.PersonAffair.all()
      - affair.owner_id = parseInt(affair.owner_id)
      - @person_id = parseInt(@person_id)

      - classes = ['item']
      - if affair.owner_id != @person_id
        - classes << 'warning'

      - relations =  I18n.t("affair.views.owner")  + ": " + affair.owner_name + "\n"
      - relations << I18n.t("affair.views.buyer")  + ": " + affair.buyer_name + "\n"
      - relations << I18n.t("affair.views.receiver") + ": " + affair.receiver_name

      %tr{:data-id => affair.id,
          :class => classes.join(" "),
          :data-title => I18n.t("affair.views.relations"),
          :data-content => relations,
          :data-placement => 'auto bottom',
          :data-trigger => 'hover'}

        %td= affair.id
        %td= affair.title
        %td.number= affair.value.to_view()
        %td.number= affair.invoices_value.to_view()
        %td.number= affair.receipts_value.to_view()
        %td= affair.statuses
        %td= affair.created_at
